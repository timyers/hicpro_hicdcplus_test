---
title: "An analysis of HiChIP data with HiCDCPlus"
author: "Tim Myers"
date: "12/14/2021"
output: 
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Description

This is a HiChIP analysis using the HiCDCPlus `R` package.  The input files used came from the output of a HiC-Pro analysis using its included sample data.  The input files are located in the /data folder.

Here I adapt the workflow outlined on the HiCDCPlus github page:
(https://github.com/mervesa/HiCDCPlus#ice-normalization-using-hitc-ice).

I identify significant interactions and differential interactions.



## Finding significant interactions from HiChIP

Load required libraries
```{r load-lib, eval=TRUE}
library(HiCDCPlus)
library(BSgenome.Hsapiens.UCSC.hg19)
library(DESeq2)
library(HiTC)
```

# Generate Features
```{r features, eval=TRUE}
# define output directory path
out_dir <- "/Users/myersta/Box/Rprojects/hichip/hicpro_hicdcplus_test/Output"

# generate genomic features
construct_features(output_path = paste0(out_dir, "/hg19_5kb_hindiii"),
                   gen = "Hsapiens",
                   gen_ver = "hg19",
                   sig = "AGCTT",
                   bin_type = "Bins-uniform",
                   binsize = 5000,
                   chrs = c("chr21","chr22")
                  )
```

Generate `gi_list` to store counts and features.
```{r gen-gi-list, eval = TRUE}
# generate gi_list instance
gi_list <- generate_bintolen_gi_list(
             bintolen_path = paste0(paste0(out_dir, "/hg19_5kb_hindiii"))
            )

# add HiCPro .allValidPairs
### define path to .allValidPairs files

gi_list <- add_hic_counts(gi_list, hic_path = hicfile_path)

```
